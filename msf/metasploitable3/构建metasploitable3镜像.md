# 0x00
**主机系统：Windows11**

**辅助资料：**
如果你实在搞不懂，你可以配合观看这个youtube视频来完成此次操作。
https://www.youtube.com/watch?v=Zd6NFfVsYfc

# `必要条件你的C盘可用内存必须不小于30GB`
1.下载并安装Vagrant
https://www.vagrantup.com/downloads

2.下载并安装Vagrant VMWare utility
https://www.vagrantup.com/docs/providers/vmware/vagrant-vmware-utility

3.下载Packer
https://www.packer.io/downloads

4.Clone repo (download zip file): 
https://github.com/rapid7/metasploitable3

5.把packer.exe复制到解压文件里（metasploitable3-master），以管理员权限运行Powershell，然后cd到解压文件的路径里。

# 0x01
```
vagrant plugin install vagrant-vmware-desktop
```

# 0x02
```
vagrant box list
```

注：
如果显示 **There are no installed boxes! Use `vagrant box add` to add some.**  
说明没有任何问题，可执行下一步。
如果存在rapid7/metasploitable3-win2k8或者rapid7/metasploitable3-ub1404，那么需要使用如下命令移除。

```
vagrant box remove [rapid7/metasploitable3-win2k8] --provider vmware-desktop
```

# 0x03
```
 vagrant box add rapid7/metasploitable3-win2k8 --provider vmware_desktop
```

```
 vagrant box add rapid7/metasploitable3-ub1404 --provider vmware_desktop

```

# 0x04
```
vagrant up --provider=vmware_desktop
```

# 0x05
**完成上面操作，代表你已经成功构建metasploitable3镜像。**
生成的`VMware镜像`在metasploitable3-master\\.vagrant\\machines

现在你可以找到.vmx文件，然后在虚拟机里面打开。在kali里面尝试ping这两台靶机。
如果windows系统的靶机`ping不通`，**请尝试关闭Windows防火墙。**
如果Linux系统的靶机ping不通，请尝试在`虚拟机设置`里面**移除网络适配器**，然后再添加一个新的网络适配器，重新启动系统即可。

【**资料附录**】
- 1.Windows使用cmd命令关闭防火墙
	https://blog.csdn.net/weixin_43891448/article/details/106083771
	关闭防火墙：`netsh firewall set opmode mode=disable`  
	关闭防火墙： `netsh advfirewall set allprofiles state off`  
	查看防火墙状态： `netsh advfirewall show allprofiles`
	防火墙恢复默认配置：`netsh firewall reset`


